//query DeviceEvents table for all occurrences of Exploit Guard audit events
//Use this data to assess impact of EG, and possibly make exceptions for known/trusted binaries
//jesse.esquivel@microsoft.com
//All audited events for Exploit Guard stack
DeviceEvents
 | where ActionType startswith "ExploitGuard"
 | where ActionType contains "Audited"
 | extend RuleGuid = tolower(tostring(parsejson(AdditionalFields).RuleId))
 | summarize DevicesImpacted=dcount(DeviceName) by InitiatingProcessFileName, ActionType, RuleGuid
 | project DevicesImpacted, InitiatingProcessFileName, ActionType, RuleGuid 
